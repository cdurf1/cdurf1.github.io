
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Distributed Asynchronous Object Storage">
      
      
      
        <meta name="author" content="DAOS Project">
      
      
        <link rel="canonical" href="http://daos.io/v1.2/QSG/tour/">
      
      <link rel="icon" href="../../daos_logo_wh.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Admin/Client Tools - DAOS v1.2</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#02a6f2">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Ubuntu";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="blue">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#daos-tour" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="http://daos.io" title="DAOS v1.2" class="md-header__button md-logo" aria-label="DAOS v1.2" data-md-component="logo">
      
  <img src="../../daos_logo_wh.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DAOS v1.2
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Admin/Client Tools
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        
<a href="https://github.com/daos-stack/daos/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    daos-stack/daos
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../overview/terminology/" class="md-tabs__link">
        Architecture Overview
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../setup/" class="md-tabs__link md-tabs__link--active">
        Installation and Setup
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../admin/hardware/" class="md-tabs__link">
        Administration Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../user/container/" class="md-tabs__link">
        User Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../autotest/" class="md-tabs__link">
        Test and Benchmarking
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../release/release_notes_v1_2/" class="md-tabs__link">
        Releases
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../dev/development/" class="md-tabs__link">
        Developer Zone
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://wiki.hpdd.intel.com" class="md-tabs__link">
      Community Wiki
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://wiki.hpdd.intel.com/display/DC/Roadmap/" class="md-tabs__link">
      Roadmap
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://daos.groups.io/g/daos" class="md-tabs__link">
      Mailing list
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://jira.hpdd.intel.com/projects/DAOS" class="md-tabs__link">
      Issue tracker
    </a>
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="http://daos.io" title="DAOS v1.2" class="md-nav__button md-logo" aria-label="DAOS v1.2" data-md-component="logo">
      
  <img src="../../daos_logo_wh.png" alt="logo">

    </a>
    DAOS v1.2
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/daos-stack/daos/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    daos-stack/daos
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Architecture Overview
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Architecture Overview" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Architecture Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/terminology/" class="md-nav__link">
        Terminology
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/storage/" class="md-nav__link">
        Storage Model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/transaction/" class="md-nav__link">
        Transaction Model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/fault/" class="md-nav__link">
        Fault Model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/security/" class="md-nav__link">
        Security Model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Installation and Setup
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation and Setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Installation and Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        CentOS Setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../suse_setup/" class="md-nav__link">
        openSUSE Setup
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Admin/Client Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Admin/Client Tools
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    Set-Up
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#daos-management-tool-dmg-usage-for-daos_admin" class="md-nav__link">
    DAOS management tool (dmg) usage for daos_admin
  </a>
  
    <nav class="md-nav" aria-label="DAOS management tool (dmg) usage for daos_admin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dmg-tool-help" class="md-nav__link">
    dmg tool help
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmg-system-query" class="md-nav__link">
    dmg system query
  </a>
  
    <nav class="md-nav" aria-label="dmg system query">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dmg-system-query-verbose-output" class="md-nav__link">
    dmg system query verbose output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dmg-system-query-with-debug" class="md-nav__link">
    dmg system query with debug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dmg-storage-query-usage" class="md-nav__link">
    dmg storage query usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmg-pool-create-help" class="md-nav__link">
    dmg pool create help
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmg-pool-create" class="md-nav__link">
    dmg pool create
  </a>
  
    <nav class="md-nav" aria-label="dmg pool create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dmg-pool-create-for-specified-user-and-group" class="md-nav__link">
    dmg pool create for specified user and group
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dmg-pool-create-with-security-setting" class="md-nav__link">
    dmg pool create with security setting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dmg-pool-list" class="md-nav__link">
    dmg pool list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dmg-pool-destroy" class="md-nav__link">
    dmg pool destroy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dmg-pool-query" class="md-nav__link">
    dmg pool query
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#daos-tool-daos-usage-for-daos_client" class="md-nav__link">
    DAOS tool (daos) usage for daos_client
  </a>
  
    <nav class="md-nav" aria-label="DAOS tool (daos) usage for daos_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#daos-tool-help" class="md-nav__link">
    daos tool help
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daos-container-create" class="md-nav__link">
    daos container create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daos-container-create-with-hdf5-type" class="md-nav__link">
    daos container create with HDF5 type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daos-container-create-with-redundancy-factor" class="md-nav__link">
    daos container create with redundancy factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daos-container-list" class="md-nav__link">
    daos container list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daos-container-destroy" class="md-nav__link">
    daos container destroy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daos-container-query" class="md-nav__link">
    daos container query
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daos-container-snapshot-helpcreatelistdestroy" class="md-nav__link">
    daos container snapshot help/create/list/destroy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-errors-and-workarounds" class="md-nav__link">
    Common errors and workarounds
  </a>
  
    <nav class="md-nav" aria-label="Common errors and workarounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-dmg-command-without-daos_admin-privilege" class="md-nav__link">
    Use dmg command without daos_admin privilege
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-daos-command-before-daos_agent-started" class="md-nav__link">
    use daos command before daos_agent started
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-daos-command-with-invalid-or-wrong-parameters" class="md-nav__link">
    use daos command with invalid or wrong parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmg-pool-create-failed-due-to-no-space" class="md-nav__link">
    dmg pool create failed due to no space
  </a>
  
    <nav class="md-nav" aria-label="dmg pool create failed due to no space">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dmg-pool-destroy-timeout" class="md-nav__link">
    dmg pool destroy timeout
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-with-dfuse-fio" class="md-nav__link">
    Run with dfuse fio
  </a>
  
    <nav class="md-nav" aria-label="Run with dfuse fio">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-rpm" class="md-nav__link">
    required rpm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-fio" class="md-nav__link">
    run fio
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unmount" class="md-nav__link">
    unmount
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-with-mpirun-mdtest" class="md-nav__link">
    Run with mpirun mdtest
  </a>
  
    <nav class="md-nav" aria-label="Run with mpirun mdtest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-rpms" class="md-nav__link">
    required rpms
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-mpirun-ior-and-mdtest" class="md-nav__link">
    run mpirun ior and mdtest
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../test_index/" class="md-nav__link">
        Test and Benchmarking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://wiki.hpdd.intel.com/display/DC/DAOS+IO-500+Instructions" class="md-nav__link">
        IO500 Setup
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Administration Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Administration Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Administration Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/hardware/" class="md-nav__link">
        Hardware Requirements
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/installation/" class="md-nav__link">
        Software Installation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/predeployment_check/" class="md-nav__link">
        Pre-deployment Checklist
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/deployment/" class="md-nav__link">
        System Deployment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/administration/" class="md-nav__link">
        System Administration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/pool_operations/" class="md-nav__link">
        Pool Operations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/tiering_uns/" class="md-nav__link">
        Tiering and Unified Namespace
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/performance_tuning/" class="md-nav__link">
        Performance Tuning
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/utilities_examples/" class="md-nav__link">
        Utilities and Usage Examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/env_variables/" class="md-nav__link">
        Environment Variables
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        User Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/container/" class="md-nav__link">
        Container Management
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/interface/" class="md-nav__link">
        Native Programming Interface
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/posix/" class="md-nav__link">
        POSIX Namespace
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/mpi-io/" class="md-nav__link">
        MPI-IO Support
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/hdf5/" class="md-nav__link">
        HDF5 Support
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/spark/" class="md-nav__link">
        Spark and Hadoop
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Test and Benchmarking
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test and Benchmarking" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Test and Benchmarking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../autotest/" class="md-nav__link">
        Run DAOS Autotest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cartselftest/" class="md-nav__link">
        Run CaRT Self_test
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../runior/" class="md-nav__link">
        Run IOR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../mdtest/" class="md-nav__link">
        Run mdtest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dbench/" class="md-nav__link">
        Run dbench
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../datamover/" class="md-nav__link">
        Datamover test
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Releases
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Releases" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Releases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../release/release_notes_v1_2/" class="md-nav__link">
        Release Notes v1.2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../release/support_matrix/" class="md-nav__link">
        Support Matrix
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Developer Zone
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developer Zone" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Developer Zone
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/development/" class="md-nav__link">
        Dev Environment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/daos-stack/daos/blob/master/src/README.md" class="md-nav__link">
        DAOS Internals
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../html/" class="md-nav__link">
        DAOS API Documentation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://wiki.hpdd.intel.com" class="md-nav__link">
        Community Wiki
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://wiki.hpdd.intel.com/display/DC/Roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://daos.groups.io/g/daos" class="md-nav__link">
        Mailing list
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://jira.hpdd.intel.com/projects/DAOS" class="md-nav__link">
        Issue tracker
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/daos-stack/daos/edit/master/docs/QSG/tour.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="daos-tour">DAOS Tour<a class="headerlink" href="#daos-tour" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>This documentation provides a general tour to the DAOS management commands
(dmg) for daos_admin, and DAOS tools (daos) for daos_client users.
Help and setup for the following is provided in this chapter:</p>
<ul>
<li>Pool and Container create, list, query and destroy on
DAOS server for daos_admin and daos_client users.</li>
<li>Common errors and workarounds for new users when using the dmg and daos tools. </li>
<li>Example runs of data transfer between DAOS file systems, by setting up
of the DAOS dfuse mount point and run traffic with dfuse fio and mpirun
mdtest.</li>
<li>Examples of basic dmg and daos tools run on 2 host DAOS servers
and 1 host client, and runs of DAOS rebuild over dfuse fio and mpirun mdtest
on a 4 host DAOS server.</li>
</ul>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h2>
<p>Set environment variables for list of servers, client and admin node.</p>
<pre><code># Example of 2 hosts server

# For 1 host server, export SERVER_NODES=node-1

export SERVER_NODES=node-1,node-2

# Example to use admin and client on the same node

export ADMIN_NODE=node-3

export CLIENT_NODE=node-3

export ALL_NODES=$SERVER_NODES,$CLIENT_NODE
</code></pre>
<h2 id="set-up">Set-Up<a class="headerlink" href="#set-up" title="Permanent link">&para;</a></h2>
<p>Refer to the <a href="../setup/">DAOS CentOS Setup</a> or the <a href="../suse_setup/">DAOS openSUSE Setup</a> for RPM installation, daos
server/agent/admin configuration yml files, certificate generation, and
bring-up DAOS servers and clients.</p>
<h2 id="daos-management-tool-dmg-usage-for-daos_admin">DAOS management tool (dmg) usage for daos_admin<a class="headerlink" href="#daos-management-tool-dmg-usage-for-daos_admin" title="Permanent link">&para;</a></h2>
<h3 id="dmg-tool-help">dmg tool help<a class="headerlink" href="#dmg-tool-help" title="Permanent link">&para;</a></h3>
<pre><code># DAOS management tool full path /usr/bin/dmg

$ dmg --help
Usage:
    dmg [OPTIONS] &lt;command&gt;
Application Options:
        --allow-proxy       Allow proxy configuration via environment
    -l, --host-list=        comma separated list of addresses &lt;ipv4addr/hostname&gt;
    -i, --insecure          have dmg attempt to connect without certificates
    -d, --debug             enable debug output
    -j, --json              Enable JSON output
    -J, --json-logging      Enable JSON-formatted log output
    -o, --config-path=      Client config file path

Help Options:
-h, --help      Show this help message

Available commands:
    config      Perform tasks related to configuration of hardware remote servers (aliases: co)
    cont        Perform tasks related to DAOS containers (aliases: c)
    network     Perform tasks related to network devices attached to remote servers (aliases: n)
    pool        Perform tasks related to DAOS pools (aliases: p)
    storage     Perform tasks related to storage attached to remote servers (aliases: st)
    system      Perform distributed tasks related to DAOS system (aliases: sy)
    telemetry   Perform telemetry operations
    version     Print dmg version
</code></pre>
<h2 id="dmg-system-query">dmg system query<a class="headerlink" href="#dmg-system-query" title="Permanent link">&para;</a></h2>
<pre><code># system query output for a 2 hosts DAOS server
$ dmg system query
Rank    State
----    ----
[0-1]   Joined
</code></pre>
<h3 id="dmg-system-query-verbose-output">dmg system query verbose output<a class="headerlink" href="#dmg-system-query-verbose-output" title="Permanent link">&para;</a></h3>
<pre><code>$ dmg system query --verbose (-v)
Rank    UUID    Control Address Fault Domain    State   Reason
----    ----    --------------- ------------    -----   ------
0   570660ae-1727-4ce0-9650-6c31e81c9d30 10.7.1.8:10001 /boro-8.boro.hpdd.intel.com Joined
1   74390dd0-7fbc-4309-8665-d5f24218c8d9 10.7.1.35:10001 /boro-35.boro.hpdd.intel.com Joined
</code></pre>
<h3 id="dmg-system-query-with-debug">dmg system query with debug<a class="headerlink" href="#dmg-system-query-with-debug" title="Permanent link">&para;</a></h3>
<pre><code>$ dmg system query --debug (-d)
DEBUG 21:17:29.765815 main.go:216: debug output enabled
DEBUG 21:17:29.766483 main.go:243: control config loaded from /etc/daos/daos_control.yml
DEBUG 21:17:29.768661 system.go:368: DAOS system query request: &amp;{unaryRequest:{request:{deadline:{wall:0 ext:0 loc:&lt;nil&gt;} Sys: HostList []} rpc:0xc83b40} msRequest:{} sysRequest:{Ranks:{RWMutex:{w:{state:0 sema:0} writerSem:0 readerSem:0 readerCount:0 readerWait:0} HostSet:{Mutex:{state:0 sema:0} list:0xc0001909c0}} Hosts:{Mutex:{state:0 sema:0} list:0xc000190980}} retryableRequest:{retryTimeout:0 retryInterval:0 retryMaxTries:0 retryTestFn:0xc83ca0 retryFn:0xc83de0} FailOnUnavailable:false}
DEBUG 21:17:29.769332 rpc.go:196: request hosts: [boro-8:10001boro-35:10001]
DEBUG 21:17:29.823432 system.go:200: System-Query command succeeded, absent hosts: , absent ranks:
Rank State
---- -----
[0-1] Joined
</code></pre>
<h3 id="dmg-storage-query-usage">dmg storage query usage<a class="headerlink" href="#dmg-storage-query-usage" title="Permanent link">&para;</a></h3>
<pre><code># system storage query usage output for a 2 hosts DAOS server
$ dmg storage query usage
Hosts   SCM-Total   SCM-Free    SCM-Used    NVMe-Total  NVMe-Free   NVMe-Used
-----   ---------   --------    --------    ----------  ---------   ---------
boro-35 17 GB       17 GB       0 %         0 B         0 B         N/A
boro-8  17 GB       17 GB       0 %         0 B         0 B         N/A
</code></pre>
<h2 id="dmg-pool-create-help">dmg pool create help<a class="headerlink" href="#dmg-pool-create-help" title="Permanent link">&para;</a></h2>
<pre><code>$ dmg pool create \--help
Usage:
dmg [OPTIONS] pool create [create-OPTIONS]

Application Options:

    --allow-proxy       Allow proxy configuration via environment
-l, --host-list=        comma separated list of addresses &lt;ipv4addr/hostname&gt;
-i, --insecure          have dmg attempt to connect without certificates
-d, --debug             enable debug output
-j, --json              Enable JSON output
-J, --json-logging      Enable JSON-formatted log output
-o, --config-path=      Client config file path

Help Options:
-h, --help  Show this help message

[create command options]
    -g, --group=        DAOS pool to be owned by given group, format name\@domain
    -u, --user=         DAOS pool to be owned by given user, format name\@domain
    -p, --name=         Unique name for pool (set as label)
    -a, --acl-file=     Access Control List file path for DAOS pool
    -z, --size=         Total size of DAOS pool (auto)
    -t, --scm-ratio=    Percentage of SCM:NVMe for pool storage (auto) (default: 6)
    -k, --nranks=       Number of ranks to use (auto)
    -v, --nsvc=         Number of pool service replicas
    -s, --scm-size=     Per-server SCM allocation for DAOS pool (manual)
    -n, --nvme-size=    Per-server NVMe allocation for DAOS pool (manual)
    -r, --ranks=        Storage server unique identifiers (ranks) for DAOS pool
    -S, --sys=          DAOS system that pool is to be a part of (default: daos_server)
</code></pre>
<h2 id="dmg-pool-create">dmg pool create<a class="headerlink" href="#dmg-pool-create" title="Permanent link">&para;</a></h2>
<pre><code># Create a 10GB pool
$ dmg pool create --size=10G
Creating DAOS pool with automatic storage allocation: 10 GB NVMe + 6.00% SCM
Pool created with 100.00% SCM/NVMe ratio
----------------------------------------
    UUID            : 0a6003c6-23a7-4cb5-8895-c004ca2b75f5
    Service Ranks   : 0
    Storage Ranks   : \[0-1\]
    Total Size      : 10 GB
    SCM             : 10 GB (5.0 GB / rank)
    NVMe            : 0 B (0 B / rank)

$ dmg storage query usage
Hosts   SCM-Total   SCM-Free    SCM-Used    NVMe-Total  NVMe-Free   NVMe-Used
-----   ---------   --------    --------    ----------  ---------   ---------
boro-35 17 GB       12 GB       29 %        0 B         0 B         N/A
boro-8  17 GB       11 GB       36 %        0 B         0 B         N/A
</code></pre>
<h3 id="dmg-pool-create-for-specified-user-and-group">dmg pool create for specified user and group<a class="headerlink" href="#dmg-pool-create-for-specified-user-and-group" title="Permanent link">&para;</a></h3>
<pre><code># Create a 1GB pool for user:user_1 group:admin_group1
$ dmg pool create --group=admin_group1 --user=user_1 --size=1G
Creating DAOS pool with automatic storage allocation: 1.0 GB NVMe + 6.00% SCM
Pool created with 100.00% SCM/NVMe ratio
----------------------------------------
UUID            : 64efd827-6bcb-434b-ab78-2010984539ff
Service Ranks   : 0
Storage Ranks   : 0
Total Size      : 1.0 GB
SCM             : 1.0 GB (1.0 GB / rank)
NVMe            : 0 B (0 B / rank)
</code></pre>
<h3 id="dmg-pool-create-with-security-setting">dmg pool create with security setting<a class="headerlink" href="#dmg-pool-create-with-security-setting" title="Permanent link">&para;</a></h3>
<pre><code># Create a pool with access-control via a access-list test file
$ dmg pool create --size=1G --acl-file=/tmp/acl_test.txt
Creating DAOS pool with automatic storage allocation: 1.0 GB NVMe + 6.00% SCM
Pool created with 100.00% SCM/NVMe ratio
----------------------------------------
UUID            : 4533f724-7234-4c70-946c-b7a53d7d0ddf
Service Ranks   : 0
Storage Ranks   : 0
Total Size      : 1.0 GB
SCM             : 1.0 GB (1.0 GB / rank)
NVMe            : 0 B (0 B / rank)

# Example of access entries on /tmp/acl_test.txt
# pool OWNER: read-write permission
# pool owner GROUP: read-write permission
#  test_user1: write-only permission
#  test_user2: read-only permission
#  test_group1: write-only permission
#  test_group2: read-only permission
#  EVERYONE else: no permission
A::OWNER@:rw
A:G:GROUP@:rw
A::test_user1@:w
A::test_user2@:r
A:G:test_group1@:w
A:G:test_group2@:r
A::EVERYONE@:

# Get pool security acl
$ dmg pool get-acl --pool=$DAOS_POOL
# Entries:
A::OWNER@:rw
A::test_user1@:w
A::test_user2@:r
A:G:GROUP@:rw
A:G:test_group1@:w
A:G:test_group2@:r
A::EVERYONE@:

# Update pool access entry for the existing test_group1 to no-permission
dmg pool update-acl -e A:G:test_group1@: --pool=$DAOS_POOL

# Update pool access entry for a new user test_user3 with rw permission
dmg pool update-acl -e A::test_user3@:rw --pool=$DAOS_POOL

# Get pool security acl after update-acl
$ dmg pool get-acl --pool=$DAOS_POOL

# Entries:
A::OWNER@:rw
A::test_user1@:w
A::test_user2@:r
A::test_user3@:rw
A:G:GROUP@:rw
A:G:test_group1@:
A:G:test_group2@:r
A::EVERYONE@:
</code></pre>
<h3 id="dmg-pool-list">dmg pool list<a class="headerlink" href="#dmg-pool-list" title="Permanent link">&para;</a></h3>
<pre><code>$ dmg pool list
Pool UUID                               Svc Replicas
---------                               ------------
5f362dc2-6154-44c7-8348-9de6f0a3d5d1    0
</code></pre>
<h3 id="dmg-pool-destroy">dmg pool destroy<a class="headerlink" href="#dmg-pool-destroy" title="Permanent link">&para;</a></h3>
<pre><code>$ dmg pool destroy --pool=$DAOS_POOL
Pool-destroy command succeeded

$ dmg pool list
no pools in system

$ dmg storage query usage
Hosts   SCM-Total   SCM-Free    SCM-Used    NVMe-Total  NVMe-Free   NVMe-Used
-----   ---------   --------    --------    ----------  ---------   ---------
boro-35 17 GB       17 GB       0 %         0 B         0 B         N/A
boro-8  17 GB       17 GB       0 %         0 B         0 B         N/A
</code></pre>
<h3 id="dmg-pool-query">dmg pool query<a class="headerlink" href="#dmg-pool-query" title="Permanent link">&para;</a></h3>
<pre><code>$ dmg pool create --size=10G
Creating DAOS pool with automatic storage allocation: 10 GB NVMe + 6.00% SCM
Pool created with 100.00% SCM/NVMe ratio
----------------------------------------
UUID            : cf860261-4fde-4403-b10b-abe8eb9dd32f
Service Ranks   : 0
Storage Ranks   : \[0-1\]
Total Size      : 10 GB
SCM             : 10 GB (5.0 GB / rank)
NVMe            : 0 B (0 B / rank)

$ dmg pool list
Pool UUID                               Svc Replicas
---------                               ------------
cf860261-4fde-4403-b10b-abe8eb9dd32f    0

$ dmg pool query --pool=$DAOS_POOL
Pool cf860261-4fde-4403-b10b-abe8eb9dd32f, ntarget=16, disabled=0, leader=0, version=1
Pool space info:
- Target(VOS) count:16
- SCM:
    Total size: 10 GB
    Free: 10 GB, min:625 MB, max:625 MB, mean:625 MB
- NVMe:
    Total size: 0 B
    Free: 0 B, min:0 B, max:0 B, mean:0 B
Rebuild idle, 0 objs, 0 recs
</code></pre>
<h2 id="daos-tool-daos-usage-for-daos_client">DAOS tool (daos) usage for daos_client<a class="headerlink" href="#daos-tool-daos-usage-for-daos_client" title="Permanent link">&para;</a></h2>
<h3 id="daos-tool-help">daos tool help<a class="headerlink" href="#daos-tool-help" title="Permanent link">&para;</a></h3>
<pre><code>$ /usr/bin/daos help
daos command (v1.2), libdaos 1.2.0
usage: daos RESOURCE COMMAND \[OPTIONS\]
resources:
    pool                pool
    container (cont)    container
    filesystem (fs)     copy to and from a POSIX filesystem
    object (obj)        object
    shell               Interactive obj ctl shell for DAOS
    version             print command version
    help                print this message and exit

use 'daos help RESOURCE' for resource specifics

$ daos help cont
daos command (v1.2), libdaos 1.2.0

container (cont) commands:
create          create a container
clone           clone a container
destroy         destroy a container
list-objects    list all objects in container
list-obj
query           query a container
get-prop        get all container\'s properties
set-prop        set container\'s properties
get-acl         get a container\'s ACL
overwrite-acl   replace a container\'s ACL
update-acl      add/modify entries in a container\'s ACL
delete-acl      delete an entry from a container\'s ACL
set-owner       change the user and/or group that own a container
stat            get container statistics
check           check objects consistency in container
list-attrs      list container user-defined attributes
del-attr        delete container user-defined attribute
get-attr        get container user-defined attribute
set-attr        set container user-defined attribute
create-snap     create container snapshot (optional name)
                at most recent committed epoch
list-snaps      list container snapshots taken
destroy-snap    destroy container snapshots
                by name, epoch or range
rollback        roll back container to specified snapshot

use 'daos help cont|container COMMAND' for command specific options
</code></pre>
<h3 id="daos-container-create">daos container create<a class="headerlink" href="#daos-container-create" title="Permanent link">&para;</a></h3>
<pre><code>$ dmg pool create --size=10G
Creating DAOS pool with automatic storage allocation: 10 GB NVMe + 6.00% SCM
Pool created with 100.00% SCM/NVMe ratio
----------------------------------------
UUID            : 528f4710-7eb8-4850-b6aa-09e4b3c8f532
Service Ranks   : 0
Storage Ranks   : 0
Total Size      : 10 GB
SCM             : 10 GB (10 GB / rank)
NVMe            : 0 B (0 B / rank)

$ daos cont create --pool=$DAOS_POOL
Successfully created container bfef23e9-bbfa-4743-a95c-144c44078f16
</code></pre>
<h3 id="daos-container-create-with-hdf5-type">daos container create with HDF5 type<a class="headerlink" href="#daos-container-create-with-hdf5-type" title="Permanent link">&para;</a></h3>
<pre><code># Create a HDF5 container
# By default: type = POSIX
$ daos cont create --type=HDF5 --pool=$DAOS_POOL
Successfully created container bc4fe707-7470-4b7d-83bf-face75cc98fc
</code></pre>
<h3 id="daos-container-create-with-redundancy-factor">daos container create with redundancy factor<a class="headerlink" href="#daos-container-create-with-redundancy-factor" title="Permanent link">&para;</a></h3>
<pre><code># Create a container with oclass RP_2G1, redundancy factor = 1
$ daos cont create --oclass=RP_2G1 --properties=rf:1 --pool=$DAOS_POOL
Successfully created container 0d121c02-a42d-4029-8dce-3919b964b7b3
</code></pre>
<h3 id="daos-container-list">daos container list<a class="headerlink" href="#daos-container-list" title="Permanent link">&para;</a></h3>
<pre><code>$ daos pool list-cont --pool=$DAOS_POOL
bc4fe707-7470-4b7d-83bf-face75cc98fc
0d121c02-a42d-4029-8dce-3919b964b7b3
</code></pre>
<h3 id="daos-container-destroy">daos container destroy<a class="headerlink" href="#daos-container-destroy" title="Permanent link">&para;</a></h3>
<pre><code>$ daos cont destroy --pool=$DAOS_POOL --cont=$DAOS_CONT
Successfully destroyed container bc4fe707-7470-4b7d-83bf-face75cc98fc
</code></pre>
<h3 id="daos-container-query">daos container query<a class="headerlink" href="#daos-container-query" title="Permanent link">&para;</a></h3>
<pre><code>$ daos cont query --pool=$DAOS_POOL --cont=$DAOS_CONT
Pool UUID: 528f4710-7eb8-4850-b6aa-09e4b3c8f532
Container UUID: bc4fe707-7470-4b7d-83bf-face75cc98fc
Number of snapshots: 0
Latest Persistent Snapshot: 0
Highest Aggregated Epoch: 172477977191481344
Container redundancy factor: 1
</code></pre>
<h3 id="daos-container-snapshot-helpcreatelistdestroy">daos container snapshot help/create/list/destroy<a class="headerlink" href="#daos-container-snapshot-helpcreatelistdestroy" title="Permanent link">&para;</a></h3>
<pre><code>$ daos help cont create-snap
daos command (v1.2), libdaos 1.2.0
container options (snapshot and rollback-related):
    --snap=NAME container snapshot (create/destroy-snap, rollback)
    --epc=EPOCHNUM container epoch (destroy-snap, rollback)
    --epcrange=B-E container epoch range (destroy-snap)
container options (query, and all commands except create):
    &lt;pool options&gt; with --cont use: (--pool, --sys-name)
    &lt;pool options&gt; with --path use: (--sys-name)
    --cont=UUID (mandatory, or use --path)
    --path=PATHSTR

$ daos cont create-snap --pool=$DAOS_POOL --cont=$DAOS_CONT
snapshot/epoch 172646116775952384 has been created

$ daos container list-snaps --pool=$DAOS_POOL --cont=$DAOS_CONT
Container's snapshots :
172478166024060928
172646116775952384

$ daos container destroy-snap --pool=$DAOS_POOL --cont=$DAOS_CONT
--epc=172646116775952384

$ daos container list-snaps --pool=$DAOS_POOL --cont=$DAOS_CONT
Container\'s snapshots :
172478166024060928
</code></pre>
<h2 id="common-errors-and-workarounds">Common errors and workarounds<a class="headerlink" href="#common-errors-and-workarounds" title="Permanent link">&para;</a></h2>
<h3 id="use-dmg-command-without-daos_admin-privilege">Use dmg command without daos_admin privilege<a class="headerlink" href="#use-dmg-command-without-daos_admin-privilege" title="Permanent link">&para;</a></h3>
<pre><code># Error message or timeout after dmg system query
$ dmg system query
ERROR: dmg: Unable to load Certificate Data: could not load cert: stat /etc/daos/certs/admin.crt: no such file or directory

# Workaround

# 1. Make sure the admin-host /etc/daos/daos_control.yml is correctly configured.
    # including:
        # hostlist: &lt;daos_server_lists&gt;
        # port: &lt;port_num&gt;
        # transport\config:
            # allow_insecure: &lt;true/false&gt;
            # ca\cert: /etc/daos/certs/daosCA.crt
            # cert: /etc/daos/certs/admin.crt
            # key: /etc/daos/certs/admin.key

# 2. Make sure the admin-host allow_insecure mode matches the applicable servers.
</code></pre>
<h3 id="use-daos-command-before-daos_agent-started">use daos command before daos_agent started<a class="headerlink" href="#use-daos-command-before-daos_agent-started" title="Permanent link">&para;</a></h3>
<pre><code>$ daos cont create --pool=$DAOS_POOL
daos ERR  src/common/drpc.c:217 unixcomm_connect() Failed to connect to /var/run/daos_agent/daos_agent.sock, errno=2(No such file or directory)
mgmt ERR  src/mgmt/cli_mgmt.c:222 get_attach_info() failed to connect to /var/run/daos_agent/daos_agent.sock DER_MISC(-1025): 'Miscellaneous error'
failed to initialize daos: Miscellaneous error (-1025)


# Work around to check for daos_agent certification and start daos_agent
    #check for /etc/daos/certs/daosCA.crt, agent.crt and agent.key
    $ sudo systemctl enable daos_agent.service
    $ sudo systemctl start daos_agent.service
</code></pre>
<h3 id="use-daos-command-with-invalid-or-wrong-parameters">use daos command with invalid or wrong parameters<a class="headerlink" href="#use-daos-command-with-invalid-or-wrong-parameters" title="Permanent link">&para;</a></h3>
<pre><code># Lack of providing daos pool_uuid
$ daos pool list-cont
pool UUID required
rc: 2
daos command (v1.2), libdaos 1.2.0
usage: daos RESOURCE COMMAND [OPTIONS]
resources:
          pool             pool
          container (cont) container
          filesystem (fs)  copy to and from a POSIX filesystem
          object (obj)     object
          shell            Interactive obj ctl shell for DAOS
          version          print command version
          help             print this message and exit
use 'daos help RESOURCE' for resource specifics

# Invalid sub-command cont-list
$ daos pool cont-list --pool=$DAOS_POOL
invalid pool command: cont-list
error parsing command line arguments
daos command (v1.2), libdaos 1.2.0
usage: daos RESOURCE COMMAND [OPTIONS]
resources:
          pool             pool
          container (cont) container
          filesystem (fs)  copy to and from a POSIX filesystem
          object (obj)     object
          shell            Interactive obj ctl shell for DAOS
          version          print command version
          help             print this message and exit
use 'daos help RESOURCE' for resource specifics

# Working daos pool command
$ daos pool list-cont --pool=$DAOS_POOL
bc4fe707-7470-4b7d-83bf-face75cc98fc
</code></pre>
<h2 id="dmg-pool-create-failed-due-to-no-space">dmg pool create failed due to no space<a class="headerlink" href="#dmg-pool-create-failed-due-to-no-space" title="Permanent link">&para;</a></h2>
<pre><code>$ dmg pool create --size=50G
Creating DAOS pool with automatic storage allocation: 50 GB NVMe + 6.00% SCM
ERROR: dmg: pool create failed: DER_NOSPACE(-1007): No space on storage target

# Workaround: dmg storage query scan to find current available storage
    dmg storage query usage
    Hosts  SCM-Total SCM-Free SCM-Used NVMe-Total NVMe-Free NVMe-Used
    -----  --------- -------- -------- ---------- --------- ---------
    boro-8 17 GB     6.0 GB   65 %     0 B        0 B       N/A

    $ dmg pool create --size=2G
    Creating DAOS pool with automatic storage allocation: 2.0 GB NVMe + 6.00% SCM
    Pool created with 100.00% SCM/NVMe ratio
    -----------------------------------------
      UUID          : b5ce2954-3f3e-4519-be04-ea298d776132
      Service Ranks : 0
      Storage Ranks : 0
      Total Size    : 2.0 GB
      SCM           : 2.0 GB (2.0 GB / rank)
      NVMe          : 0 B (0 B / rank)

    $ dmg storage query usage
    Hosts  SCM-Total SCM-Free SCM-Used NVMe-Total NVMe-Free NVMe-Used
    -----  --------- -------- -------- ---------- --------- ---------
    boro-8 17 GB     2.9 GB   83 %     0 B        0 B       N/A
</code></pre>
<h3 id="dmg-pool-destroy-timeout">dmg pool destroy timeout<a class="headerlink" href="#dmg-pool-destroy-timeout" title="Permanent link">&para;</a></h3>
<pre><code># dmg pool destroy Timeout or failed due to pool has active container(s)
# Workaround pool destroy --force option

    $ dmg pool destroy --pool=$DAOS_POOL --force
    Pool-destroy command succeeded
</code></pre>
<h2 id="run-with-dfuse-fio">Run with dfuse fio<a class="headerlink" href="#run-with-dfuse-fio" title="Permanent link">&para;</a></h2>
<h3 id="required-rpm">required rpm<a class="headerlink" href="#required-rpm" title="Permanent link">&para;</a></h3>
<pre><code>$ sudo yum install -y fio
or
$ sudo yum install -y daos-tests
</code></pre>
<h3 id="run-fio">run fio<a class="headerlink" href="#run-fio" title="Permanent link">&para;</a></h3>
<pre><code>$ dmg pool create --size=10G
$ daos cont create --pool=$DAOS_POOL --type=POSIX
$ daos cont query --pool=$DAOS_POOL --cont=$DAOS_CONT
Pool UUID: f688f2ad-76ae-4368-8d1b-5697ca016a43
Container UUID: bcc5c793-60dc-4ec1-8bab-9d63ea18e794
Number of snapshots: 0
Latest Persistent Snapshot: 0
Highest Aggregated Epoch: 0
Container redundancy factor: 0
$ /usr/bin/mkdir /tmp/daos_test1
$ /usr/bin/touch /tmp/daos_test1/testfile
$ /usr/bin/df -h -t fuse.daos
df: no file systems processed
$ /usr/bin/dfuse --m=/tmp/daos_test1 --pool=$DAOS_POOL --cont=$DAOS_CONT
$ /usr/bin/df -h -t fuse.daos
Filesystem Size Used Avail Use% Mounted on
dfuse 954M 144K 954M 1% /tmp/daos_test1
$ /usr/bin/fio --name=random-write --ioengine=pvsync --rw=randwrite --bs=4k --size=128M --nrfiles=4 --directory=/tmp/daos_test1 --numjobs=8 --iodepth=16 --runtime=60 --time_based --direct=1 --buffered=0 --randrepeat=0 --norandommap --refill_buffers --group_reportingrandom-write: (g=0): rw=randwrite, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=pvsync, iodepth=16
...
fio-3.7
Starting 8 processes
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
write: IOPS=19.9k, BW=77.9MiB/s (81.7MB/s)(731MiB/9379msec)
clat (usec): min=224, max=6539, avg=399.16, stdev=70.52
lat (usec): min=224, max=6539, avg=399.19, stdev=70.52
clat percentiles (usec):
...
bw ( KiB/s): min= 9368, max=10096, per=12.50%, avg=9972.06, stdev=128.28, samples=144
iops : min= 2342, max= 2524, avg=2493.01, stdev=32.07, samples=144
lat (usec) : 250=0.01%, 500=96.81%, 750=3.17%, 1000=0.01%
lat (msec) : 10=0.01%
cpu : usr=0.43%, sys=1.05%, ctx=187242, majf=0, minf=488
IO depths : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%
submit : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%
complete : 0=0.1%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%
issued rwts: total=0,187022,0,0 short=0,0,0,0 dropped=0,0,0,0
latency : target=0, window=0, percentile=100.00%, depth=16
Run status group 0 (all jobs):
WRITE: bw=77.9MiB/s (81.7MB/s), 77.9MiB/s-77.9MiB/s (81.7MB/s-81.7MB/s), io=731MiB (766MB), run=9379-9379msec

# Data after fio completed
$ ll /tmp/daos_test1
total 1048396
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.0.0
rw-rr- 1 user1 user1 33546240 Apr 21 23:28 random-write.0.1
rw-rr- 1 user1 user1 33542144 Apr 21 23:28 random-write.0.2
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.0.3
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.1.0
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.1.1
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.1.2
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.1.3
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.2.0
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.2.1
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.2.2
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.2.3
rw-rr- 1 user1 user1 33542144 Apr 21 23:28 random-write.3.0
rw-rr- 1 user1 user1 33550336 Apr 21 23:28 random-write.3.1
rw-rr- 1 user1 user1 33550336 Apr 21 23:28 random-write.3.2
rw-rr- 1 user1 user1 33542144 Apr 21 23:28 random-write.3.3
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.4.0
rw-rr- 1 user1 user1 33525760 Apr 21 23:28 random-write.4.1
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.4.2
rw-rr- 1 user1 user1 33550336 Apr 21 23:28 random-write.4.3
rw-rr- 1 user1 user1 33542144 Apr 21 23:28 random-write.5.0
rw-rr- 1 user1 user1 33546240 Apr 21 23:28 random-write.5.1
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.5.2
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.5.3
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.6.0
rw-rr- 1 user1 user1 33550336 Apr 21 23:28 random-write.6.1
rw-rr- 1 user1 user1 33550336 Apr 21 23:28 random-write.6.2
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.6.3
rw-rr- 1 user1 user1 33525760 Apr 21 23:28 random-write.7.0
rw-rr- 1 user1 user1 33554432 Apr 21 23:28 random-write.7.1
rw-rr- 1 user1 user1 33525760 Apr 21 23:28 random-write.7.2
rw-rr- 1 user1 user1 33542144 Apr 21 23:28 random-write.7.3
</code></pre>
<h3 id="unmount">unmount<a class="headerlink" href="#unmount" title="Permanent link">&para;</a></h3>
<pre><code>$ fusermount -u /tmp/daos_test1/

$ df -h -t fuse.daos
df: no file systems processed
</code></pre>
<h2 id="run-with-mpirun-mdtest">Run with mpirun mdtest<a class="headerlink" href="#run-with-mpirun-mdtest" title="Permanent link">&para;</a></h2>
<h3 id="required-rpms">required rpms<a class="headerlink" href="#required-rpms" title="Permanent link">&para;</a></h3>
<pre><code>$ sudo yum install -y mpich
$ sudo yum install -y mdtest
$ sudo yum install -y Lmod
$ sudo module load mpi/mpich-x86_64
$ /usr/bin/touch /tmp/daos_test1/testfile
</code></pre>
<h3 id="run-mpirun-ior-and-mdtest">run mpirun ior and mdtest<a class="headerlink" href="#run-mpirun-ior-and-mdtest" title="Permanent link">&para;</a></h3>
<pre><code># Run mpirun ior
$ /usr/lib64/mpich/bin/mpirun -host &lt;host1&gt; -np 30 ior -a POSIX -b 26214400 -v -w -k -i 1 -o /tmp/daos_test1/testfile -t 25M
IOR-3.4.0+dev: MPI Coordinated Test of Parallel I/O
Began : Fri Apr 16 18:07:56 2021
Command line : ior -a POSIX -b 26214400 -v -w -k -i 1 -o /tmp/daos_test1/testfile -t 25M
Machine : Linux boro-8.boro.hpdd.intel.com
Start time skew across all tasks: 0.00 sec
TestID : 0
StartTime : Fri Apr 16 18:07:56 2021
Path : /tmp/daos_test1/testfile
FS : 3.8 GiB Used FS: 1.1% Inodes: 0.2 Mi Used Inodes: 0.1%
Participating tasks : 30
Options:
api : POSIX
apiVersion :
test filename : /tmp/daos_test1/testfile
access : single-shared-file
type : independent
segments : 1
ordering in a file : sequential
ordering inter file : no tasks offsets
nodes : 1
tasks : 30
clients per node : 30
repetitions : 1
xfersize : 25 MiB
blocksize : 25 MiB
aggregate filesize : 750 MiB
verbose : 1
Results:
access bw(MiB/s) IOPS Latency(s) block(KiB) xfer(KiB) open(s) wr/rd(s) close(s) total(s) iter
------ --------- ---- ---------- ---------- --------- -------- -------- -------- -------- ----
Commencing write performance test: Fri Apr 16 18:07:56 2021
write 1499.68 59.99 0.480781 25600 25600 0.300237 0.500064 0.483573 0.500107 0
Max Write: 1499.68 MiB/sec (1572.53 MB/sec)
Summary of all tests:
Operation Max(MiB) Min(MiB) Mean(MiB) StdDev Max(OPs) Min(OPs) Mean(OPs) StdDev Mean(s) Stonewall(s) Stonewall(MiB) Test# #Tasks tPN reps fPP reord reordoff reordrand seed segcnt blksiz xsize aggs(MiB) API RefNum
write 1499.68 1499.68 1499.68 0.00 59.99 59.99 59.99 0.00 0.50011 NA NA 0 30 30 1 0 0 1 0 0 1 26214400 26214400 750.0 POSIX 0
Finished : Fri Apr 16 18:07:57 2021
</code></pre>
<h1 id="run-mpirun-mdtest">Run mpirun mdtest<a class="headerlink" href="#run-mpirun-mdtest" title="Permanent link">&para;</a></h1>
<pre><code>$ /usr/lib64/mpich/bin/mpirun -host &lt;host1&gt; -np 30 mdtest -a DFS -z 0 -F -C -i 1 -n 1667 -e 4096 -d / -w 4096 --dfs.chunk_size 1048576 --dfs.cont &lt;container.uuid&gt; --dfs.destroy --dfs.dir_oclass RP_3G1 --dfs.group daos_server --dfs.oclass RP_3G1 --dfs.pool &lt;pool_uuid&gt;
– started at 04/16/2021 22:01:55 –
mdtest-3.4.0+dev was launched with 30 total task(s) on 1 node(s)
Command line used: mdtest 'a' 'DFS' '-z' '0' '-F' '-C' '-i' '1' '-n' '1667' '-e' '4096' '-d' '/' '-w' '4096' 'dfs.chunk_size' '1048576' 'dfs.cont' '3e661024-2f1f-4d7a-9cd4-1b05601e0789' 'dfs.destroy' 'dfs.dir_oclass' 'SX' 'dfs.group' 'daos_server' 'dfs.oclass' 'SX' '-dfs.pool' 'd546a7f5-586c-4d8f-aecd-372878df7b97'
WARNING: unable to use realpath() on file system.
Path:
FS: 0.0 GiB Used FS: -nan% Inodes: 0.0 Mi Used Inodes: -nan%
Nodemap: 111111111111111111111111111111
30 tasks, 50010 files
SUMMARY rate: (of 1 iterations)
Operation Max Min Mean Std Dev
--------- — — ---- -------
File creation : 14206.584 14206.334 14206.511 0.072
File stat : 0.000 0.000 0.000 0.000
File read : 0.000 0.000 0.000 0.000
File removal : 0.000 0.000 0.000 0.000
Tree creation : 1869.791 1869.791 1869.791 0.000
Tree removal : 0.000 0.000 0.000 0.000
– finished at 04/16/2021 22:01:58 –

$ /usr/lib64/mpich/bin/mpirun -host &lt;host1&gt; -np 50 mdtest -a DFS -z 0 -F -C -i 1 -n 1667 -e 4096 -d / -w 4096 --dfs.chunk_size 1048576 --dfs.cont 3e661024-2f1f-4d7a-9cd4-1b05601e0789 --dfs.destroy --dfs.dir_oclass SX --dfs.group daos_server --dfs.oclass SX --dfs.pool d546a7f5-586c-4d8f-aecd-372878df7b97
– started at 04/16/2021 22:02:21 –
mdtest-3.4.0+dev was launched with 50 total task(s) on 1 node(s)
Command line used: mdtest 'a' 'DFS' '-z' '0' '-F' '-C' '-i' '1' '-n' '1667' '-e' '4096' '-d' '/' '-w' '4096' 'dfs.chunk_size' '1048576' 'dfs.cont' '3e661024-2f1f-4d7a-9cd4-1b05601e0789' 'dfs.destroy' 'dfs.dir_oclass' 'SX' 'dfs.group' 'daos_server' 'dfs.oclass' 'SX' '-dfs.pool' 'd546a7f5-586c-4d8f-aecd-372878df7b97'
WARNING: unable to use realpath() on file system.
Path:
FS: 0.0 GiB Used FS: -nan% Inodes: 0.0 Mi Used Inodes: -nan%
Nodemap: 11111111111111111111111111111111111111111111111111
50 tasks, 83350 files
SUMMARY rate: (of 1 iterations)
Operation Max Min Mean Std Dev
--------- — — ---- -------
File creation : 13342.303 13342.093 13342.228 0.059
File stat : 0.000 0.000 0.000 0.000
File read : 0.000 0.000 0.000 0.000
File removal : 0.000 0.000 0.000 0.000
Tree creation : 1782.938 1782.938 1782.938 0.000
Tree removal : 0.000 0.000 0.000 0.000
– finished at 04/16/2021 22:02:27 –
</code></pre>
<h2 id="run-with-4-daos-hosts-server-rebuild-with-dfuse_io-and-mpirun">Run with 4 DAOS hosts server, rebuild with dfuse_io and mpirun<a class="headerlink" href="#run-with-4-daos-hosts-server-rebuild-with-dfuse_io-and-mpirun" title="Permanent link">&para;</a></h2>
<h3 id="environment-variables-setup">Environment variables setup<a class="headerlink" href="#environment-variables-setup" title="Permanent link">&para;</a></h3>
<pre><code>export SERVER_NODES=node-1,node-2,node-3,node-4
export ADMIN_NODE=node-5
export CLIENT_NODE=node-5
export ALL_NODES=$SERVER_NODES,$CLIENT_NODE
</code></pre>
<h3 id="run-dfuse">Run dfuse<a class="headerlink" href="#run-dfuse" title="Permanent link">&para;</a></h3>
<pre><code># Bring up 4 hosts server with appropriate daos_server.yml and
# access-point, reference to  DAOS Set-Up
# After DAOS servers, DAOS admin and client started.

$ dmg storage format
Format Summary:
  Hosts             SCM Devices NVMe Devices
  -----             ----------- ------------
  boro-[8,35,52-53] 1           0

$ dmg pool list
Pool UUID Svc Replicas
--------- ------------
733bee7b-c2af-499e-99dd-313b1ef092a9
[1-3]

$ daos cont create --pool=$DAOS_POOL --type=POSIX --oclass=RP_3G1 --properties=rf:2
Successfully created container 2649aa0f-3ad7-4943-abf5-4343205a637b

$ daos pool list-cont --pool=$DAOS_POOL
2649aa0f-3ad7-4943-abf5-4343205a637b

$ dmg pool query --pool=$DAOS_POOL
Pool 733bee7b-c2af-499e-99dd-313b1ef092a9, ntarget=32, disabled=0, leader=2, version=1
Pool space info:
- Target(VOS) count:32
- SCM:
  Total size: 5.0 GB
  Free: 5.0 GB, min:156 MB, max:156 MB, mean:156 MB
- NVMe:
  Total size: 0 B
  Free: 0 B, min:0 B, max:0 B, mean:0 B
Rebuild idle, 0 objs, 0 recs

$ df -h -t fuse.daos
df: no file systems processed

$ mkdir /tmp/daos_test1

$ dfuse --mountpoint=/tmp/daos_test1 --pool=$DAOS_POOL --cont=$DAOS_CONT

$ df -h -t fuse.daos
Filesystem      Size  Used Avail Use% Mounted on
dfuse            19G  1.1M   19G   1% /tmp/daos_test1

$ fio --name=random-write --ioengine=pvsync --rw=randwrite --bs=4k --size=128M --nrfiles=4 --directory=/tmp/daos_test1 --numjobs=8 --iodepth=16 --runtime=60 --time_based --direct=1 --buffered=0 --randrepeat=0 --norandommap --refill_buffers --group_reporting
random-write: (g=0): rw=randwrite, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=pvsync, iodepth=16
...
fio-3.7
Starting 8 processes
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
random-write: Laying out IO files (4 files / total 128MiB)
Jobs: 8 (f=32): [w(8)][100.0%][r=0KiB/s,w=96.1MiB/s][r=0,w=24.6k IOPS][eta 00m:00s]
random-write: (groupid=0, jobs=8): err= 0: pid=27879: Sat Apr 17 01:12:57 2021
  write: IOPS=24.4k, BW=95.3MiB/s (99.9MB/s)(5716MiB/60001msec)
    clat (usec): min=220, max=6687, avg=326.19, stdev=55.29
     lat (usec): min=220, max=6687, avg=326.28, stdev=55.29
    clat percentiles (usec):
     |  1.00th=[  260],  5.00th=[  273], 10.00th=[  285], 20.00th=[  293],
     | 30.00th=[  306], 40.00th=[  314], 50.00th=[  322], 60.00th=[  330],
     | 70.00th=[  338], 80.00th=[  355], 90.00th=[  375], 95.00th=[  396],
     | 99.00th=[  445], 99.50th=[  465], 99.90th=[  523], 99.95th=[  562],
     | 99.99th=[ 1827]
   bw (  KiB/s): min=10976, max=12496, per=12.50%, avg=12191.82, stdev=157.87, samples=952
   iops        : min= 2744, max= 3124, avg=3047.92, stdev=39.47, samples=952
  lat (usec)   : 250=0.23%, 500=99.61%, 750=0.15%, 1000=0.01%
  lat (msec)   : 2=0.01%, 4=0.01%, 10=0.01%
  cpu          : usr=0.81%, sys=1.69%, ctx=1463535, majf=0, minf=308
  IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%
     issued rwts: total=0,1463226,0,0 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=16

Run status group 0 (all jobs):
  WRITE: bw=95.3MiB/s (99.9MB/s), 95.3MiB/s-95.3MiB/s (99.9MB/s-99.9MB/s), io=5716MiB (5993MB), run=60001-60001msec
</code></pre>
<h3 id="run-dfuse-with-rebuild">Run dfuse with rebuild<a class="headerlink" href="#run-dfuse-with-rebuild" title="Permanent link">&para;</a></h3>
<pre><code># Start dfuse
$ fio --name=random-write --ioengine=pvsync --rw=randwrite --bs=4k --size=128M --nrfiles=4 --directory=/tmp/daos_test1 --numjobs=8 --iodepth=16 --runtime=60 --time_based --direct=1 --buffered=0 --randrepeat=0 --norandommap --refill_buffers --group_reporting

random-write: (g=0): rw=randwrite, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=pvsync, iodepth=16
...
fio-3.7
Starting 8 processes
fio: io_u error on file /tmp/daos_test1/random-write.2.1: Input/output error: write offset=8527872, buflen=4096
fio: pid=28242, err=5

file:io_u.c:1747
bw ( KiB/s): min= 3272, max=12384, per=30.14%, avg=11624.50, stdev=2181.01, samples=128
iops : min= 818, max= 3096, avg=2906.12, stdev=545.25, samples=128
lat (usec) : 250=0.23%, 500=99.59%, 750=0.12%, 1000=0.01%
lat (msec) : 2=0.03%, 4=0.02%
cpu : usr=0.27%, sys=0.66%, ctx=186210, majf=0, minf=494
IO depths : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%
submit : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%
complete : 0=0.1%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%
issued rwts: total=0,186000,0,0 short=0,0,0,0 dropped=0,0,0,0
latency : target=0, window=0, percentile=100.00%, depth=16
Run status group 0 (all jobs):
WRITE: bw=37.7MiB/s (39.5MB/s), 37.7MiB/s-37.7MiB/s (39.5MB/s-39.5MB/s), io=727MiB (762MB), run=19291-19291msec
...
# from daos_admin console, stop leader-rank with debug
$ dmg -d system stop --ranks=3
DEBUG 01:34:58.026753 main.go:217: debug output enabled
DEBUG 01:34:58.027457 main.go:244: control config loaded from /etc/daos/daos_control.yml
Rank Operation Result
--------- ------
3 stop OK

$ daos pool list-cont --pool=$DAOS_POOL
cf2a95ce-9910-4d5e-814c-cafb0a7f0944

$ dmg pool query --pool=$DAOS_POOL
Pool 70f73efc-848e-4f6e-b4fd-909bcf9bd427,
ntarget=32,
disabled=8,
leader=2,
version=18
Pool space info:
Target(VOS) count:24
SCM:
Total size: 15 GB
Free: 14 GB, min:575 MB, max:597 MB, mean:587 MB
NVMe:
Total size: 0 B
Free: 0 B, min:0 B, max:0 B, mean:0 B
Rebuild done, 1 objs, 57 recs

# Verify stopped server been evicted
$ dmg system query -v
Rank UUID Control Address Fault Domain State Reason
---- --------------- ------------ ----- ------
0 2bf0e083-33d6-4ce3-83c4-c898c2a7ddbd 10.7.1.8:10001 boro-8.boro.hpdd.intel.com Joined
1 c9ac1dd9-0f9d-4684-90d3-038b720fd26b 10.7.1.35:10001 boro-35.boro.hpdd.intel.com Joined
2 80e44fe9-3a2b-4808-9a0f-88c3cbe7f565 10.7.1.53:10001 boro-53.boro.hpdd.intel.com Joined
3 a26fd44a-6089-4cc3-a06b-278a85607fd3 10.7.1.52:10001 boro-52.boro.hpdd.intel.com Evicted system stop

# Restart, after evicted server restarted, verify the server joined
$ /usr/bin/dmg system query -v
Rank UUID Control Address Fault Domain State Reason
---- --------------- ------------ ----- ------
0 2bf0e083-33d6-4ce3-83c4-c898c2a7ddbd 10.7.1.8:10001 /boro-8.boro.hpdd.intel.com Joined
1 c9ac1dd9-0f9d-4684-90d3-038b720fd26b 10.7.1.35:10001 /boro-35.boro.hpdd.intel.com Joined
2 80e44fe9-3a2b-4808-9a0f-88c3cbe7f565 10.7.1.53:10001 /boro-53.boro.hpdd.intel.com Joined
3 a26fd44a-6089-4cc3-a06b-278a85607fd3 10.7.1.52:10001 /boro-52.boro.hpdd.intel.com Joined

# Unmount after test completed
$ fusermount -u /tmp/daos_test1/
$ df -h -t fuse.daos
df: no file systems processed
</code></pre>
<h3 id="run-mpirun-mdtest-with-rebuild">Run mpirun mdtest with rebuild<a class="headerlink" href="#run-mpirun-mdtest-with-rebuild" title="Permanent link">&para;</a></h3>
<pre><code>$ dmg pool create --size=50G
Creating DAOS pool with automatic storage allocation: 50 GB NVMe + 6.00% SCM
Pool created with 100.00% SCM/NVMe ratio
-----------------------------------------
 UUID : 4eda8a8c-028c-461c-afd3-704534961572
 Service Ranks : [1-3]
 Storage Ranks : [0-3]
 Total Size : 50 GB
 SCM : 50 GB (12 GB / rank)
 NVMe : 0 B (0 B / rank)

$ daos cont create --pool=$DAOS_POOL --type=POSIX --oclass=RP_3G1 --properties=rf:2
Successfully created container d71ff6a5-15a5-43fe-b829-bef9c65b9ccb

$ /usr/lib64/mpich/bin/mpirun -host boro-8 -np 30 mdtest -a DFS -z 0 -F -C -i 100 -n 1667 -e 4096 -d / -w 4096 --dfs.chunk_size 1048576 --dfs.cont $DAOS_CONT --dfs.destroy --dfs.dir_oclass RP_3G1 --dfs.group daos_server --dfs.oclass RP_3G1 --dfs.pool $DAOS_POOL

started at 04/22/2021 17:46:20 –
mdtest-3.4.0+dev was launched with 30 total task(s) on 1 node(s)
Command line used: mdtest 'a' 'DFS' '-z' '0' '-F' '-C' '-i' '100' '-n' '1667' '-e' '4096' '-d' '/' '-w' '4096' 'dfs.chunk_size' '1048576' 'dfs.cont' 'd71ff6a5-15a5-43fe-b829-bef9c65b9ccb' 'dfs.destroy' 'dfs.dir_oclass' 'RP_3G1' 'dfs.group' 'daos_server' 'dfs.oclass' 'RP_3G1' '-dfs.pool' '4eda8a8c-028c-461c-afd3-704534961572'
WARNING: unable to use realpath() on file system.
Path:
FS: 0.0 GiB Used FS: -nan% Inodes: 0.0 Mi Used Inodes: -nan%
Nodemap: 111111111111111111111111111111
30 tasks, 50010 files
...

# from daos_admin console, stop a server rank
$ dmg system stop --ranks=2
Rank Operation Result
--------- ------
2 stop OK

# Verify stopped server been evicted
$ dmg system query -v
Rank UUID Control Address Fault Domain State Reason
 ---- --------------- ------------ ----- ------
 0 2bf0e083-33d6-4ce3-83c4-c898c2a7ddbd 10.7.1.8:10001 boro-8.boro.hpdd.intel.com Joined
 1 c9ac1dd9-0f9d-4684-90d3-038b720fd26b 10.7.1.35:10001 boro-35.boro.hpdd.intel.com Joined
 2 80e44fe9-3a2b-4808-9a0f-88c3cbe7f565 10.7.1.53:10001 boro-53.boro.hpdd.intel.com Evicted system stop
 3 a26fd44a-6089-4cc3-a06b-278a85607fd3 10.7.1.52:10001 boro-52.boro.hpdd.intel.com Joined

 # Restart, after evicted server restarted, verify the server joined
$ /usr/bin/dmg system query -v
 Rank UUID Control Address Fault Domain State Reason
 ---- --------------- ------------ ----- ------
 0 2bf0e083-33d6-4ce3-83c4-c898c2a7ddbd 10.7.1.8:10001 /boro-8.boro.hpdd.intel.com Joined
 1 c9ac1dd9-0f9d-4684-90d3-038b720fd26b 10.7.1.35:10001 /boro-35.boro.hpdd.intel.com Joined
 2 80e44fe9-3a2b-4808-9a0f-88c3cbe7f565 10.7.1.53:10001 /boro-53.boro.hpdd.intel.com Joined
 3 a26fd44a-6089-4cc3-a06b-278a85607fd3 10.7.1.52:10001 /boro-52.boro.hpdd.intel.com Joined
</code></pre>
<h2 id="clean-up">Clean-Up<a class="headerlink" href="#clean-up" title="Permanent link">&para;</a></h2>
<pre><code># pool reintegrate
$ dmg pool reintegrate --pool=$DAOS_POOL --rank=2
Reintegration command succeeded

# destroy container
$ daos container destroy --pool=$DAOS_POOL --cont=$DAOS_CONT

# destroy pool
$ dmg pool destroy --pool=$DAOS_POOL
Pool-destroy command succeeded

# stop clients
$ pdsh -S -w $CLIENT_NODES "sudo systemctl stop daos_agent.service"

# disable clients
$ pdsh -S -w $CLIENT_NODES "sudo systemctl disable daos_agent.service"

# stop servers
$ pdsh -S -w $SERVER_NODES "sudo systemctl stop daos_server.service"

# disable servers
$ pdsh -S -w $SERVER_NODES "sudo systemctl disable daos_server.service"
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../suse_setup/" class="md-footer__link md-footer__link--prev" aria-label="Previous: openSUSE Setup" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              openSUSE Setup
            </div>
          </div>
        </a>
      
      
        
        <a href="../test_index/" class="md-footer__link md-footer__link--next" aria-label="Next: Test and Benchmarking" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Test and Benchmarking
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2021 Intel Corporation
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.top", "navigation.indexes", "toc.integrate", "search.suggest", "search.highlight"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.409db549.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>