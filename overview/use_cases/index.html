
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Distributed Asynchronous Object Storage">
      
      
      
        <meta name="author" content="DAOS Project">
      
      
        <link rel="canonical" href="http://daos.io/v1.2/overview/use_cases/">
      
      <link rel="icon" href="../../daos_logo_wh.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Use Cases - DAOS v1.2</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#02a6f2">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Ubuntu";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="blue">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#use-cases" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="http://daos.io" title="DAOS v1.2" class="md-header__button md-logo" aria-label="DAOS v1.2" data-md-component="logo">
      
  <img src="../../daos_logo_wh.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DAOS v1.2
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Use Cases
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        
<a href="https://github.com/daos-stack/daos/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    daos-stack/daos
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../terminology/" class="md-tabs__link">
        Architecture Overview
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../QSG/setup/" class="md-tabs__link">
        Installation and Setup
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../admin/hardware/" class="md-tabs__link">
        Administration Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../user/container/" class="md-tabs__link">
        User Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../QSG/autotest/" class="md-tabs__link">
        Test and Benchmarking
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../release/release_notes_v1_2/" class="md-tabs__link">
        Releases
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../dev/development/" class="md-tabs__link">
        Developer Zone
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://wiki.hpdd.intel.com" class="md-tabs__link">
      Community Wiki
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://wiki.hpdd.intel.com/display/DC/Roadmap/" class="md-tabs__link">
      Roadmap
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://daos.groups.io/g/daos" class="md-tabs__link">
      Mailing list
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://jira.hpdd.intel.com/projects/DAOS" class="md-tabs__link">
      Issue tracker
    </a>
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="http://daos.io" title="DAOS v1.2" class="md-nav__button md-logo" aria-label="DAOS v1.2" data-md-component="logo">
      
  <img src="../../daos_logo_wh.png" alt="logo">

    </a>
    DAOS v1.2
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/daos-stack/daos/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    daos-stack/daos
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Architecture Overview
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Architecture Overview" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Architecture Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../terminology/" class="md-nav__link">
        Terminology
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../storage/" class="md-nav__link">
        Storage Model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../transaction/" class="md-nav__link">
        Transaction Model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fault/" class="md-nav__link">
        Fault Model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        Security Model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Installation and Setup
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation and Setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Installation and Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/setup/" class="md-nav__link">
        CentOS Setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/suse_setup/" class="md-nav__link">
        openSUSE Setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/tour/" class="md-nav__link">
        Admin/Client Tools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/test_index/" class="md-nav__link">
        Test and Benchmarking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://wiki.hpdd.intel.com/display/DC/DAOS+IO-500+Instructions" class="md-nav__link">
        IO500 Setup
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Administration Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Administration Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Administration Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/hardware/" class="md-nav__link">
        Hardware Requirements
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/installation/" class="md-nav__link">
        Software Installation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/predeployment_check/" class="md-nav__link">
        Pre-deployment Checklist
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/deployment/" class="md-nav__link">
        System Deployment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/administration/" class="md-nav__link">
        System Administration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/pool_operations/" class="md-nav__link">
        Pool Operations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/tiering_uns/" class="md-nav__link">
        Tiering and Unified Namespace
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/performance_tuning/" class="md-nav__link">
        Performance Tuning
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/utilities_examples/" class="md-nav__link">
        Utilities and Usage Examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/env_variables/" class="md-nav__link">
        Environment Variables
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        User Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/container/" class="md-nav__link">
        Container Management
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/interface/" class="md-nav__link">
        Native Programming Interface
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/posix/" class="md-nav__link">
        POSIX Namespace
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/mpi-io/" class="md-nav__link">
        MPI-IO Support
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/hdf5/" class="md-nav__link">
        HDF5 Support
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/spark/" class="md-nav__link">
        Spark and Hadoop
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Test and Benchmarking
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test and Benchmarking" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Test and Benchmarking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/autotest/" class="md-nav__link">
        Run DAOS Autotest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/cartselftest/" class="md-nav__link">
        Run CaRT Self_test
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/runior/" class="md-nav__link">
        Run IOR
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/mdtest/" class="md-nav__link">
        Run mdtest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/dbench/" class="md-nav__link">
        Run dbench
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QSG/datamover/" class="md-nav__link">
        Datamover test
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Releases
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Releases" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Releases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../release/release_notes_v1_2/" class="md-nav__link">
        Release Notes v1.2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../release/support_matrix/" class="md-nav__link">
        Support Matrix
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Developer Zone
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developer Zone" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Developer Zone
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/development/" class="md-nav__link">
        Dev Environment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/daos-stack/daos/blob/master/src/README.md" class="md-nav__link">
        DAOS Internals
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../html/" class="md-nav__link">
        DAOS API Documentation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://wiki.hpdd.intel.com" class="md-nav__link">
        Community Wiki
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://wiki.hpdd.intel.com/display/DC/Roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://daos.groups.io/g/daos" class="md-nav__link">
        Mailing list
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://jira.hpdd.intel.com/projects/DAOS" class="md-nav__link">
        Issue tracker
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/daos-stack/daos/edit/master/docs/overview/use_cases.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="use-cases">Use Cases<a class="headerlink" href="#use-cases" title="Permanent link">&para;</a></h1>
<p>This section provides a non-exhaustive list of use cases presenting how the 
DAOS storage model and stack could be used on a real HPC cluster.</p>
<p>This document contains the following sections:</p>
<ul>
<li><a href="#61">Storage Management and Workflow Integration</a></li>
<li><a href="#62">Workflow Execution</a><ul>
<li><a href="#63">Bulk Synchronous Checkpoint</a></li>
<li><a href="#64">Producer/Consumer</a></li>
<li><a href="#65">Concurrent Producers</a></li>
</ul>
</li>
<li><a href="#66">Storage Node Failure and Resilvering</a></li>
</ul>
<p><a id="61"></a></p>
<h2 id="storage-management-workflow-integration">Storage Management &amp; Workflow Integration<a class="headerlink" href="#storage-management-workflow-integration" title="Permanent link">&para;</a></h2>
<p>In this section, we consider two different cluster configurations:</p>
<ul>
<li>Cluster A: All or a majority of the compute nodes have local persistent 
  memory. In other words, each compute node is also a storage node.</li>
<li>Cluster B: Storage nodes are dedicated to storage and disseminated across 
  the fabric. They are not used for computation and thus do not run any 
  application code.</li>
</ul>
<p>At boot time, each storage node starts the DAOS server that instantiates 
service threads. In cluster A, the DAOS threads are bound to the noisy cores 
and interact with the FWK if mOS is used. In cluster B, the DAOS server can 
use all the cores of the storage node.</p>
<p>The DAOS server then loads the storage management module. This module scans 
for local storage on the node and reports the result to a designated master 
DAOS server that aggregates information about the used and available storage 
across the cluster. The management module also retrieves the fault domain 
hierarchy (from a database or specific service) and integrates this with the 
storage information.</p>
<p>The resource manager then uses the DAOS management API to query available 
storage and allocate a certain amount of storage (i.e. persistent memory) 
for a new workflow that is to be scheduled. In cluster A, this allocation 
request may list the compute nodes where the workflow is supposed to run, 
whereas in case B, it may ask for storage nearby some allocated compute nodes.</p>
<p>Once successfully allocated, the master server will initialize a DAOS pool 
covering the allocated storage by formatting the VOS layout (i.e. fallocate(1) 
a PMEM file &amp; create VOS super block) and starting the pool service which 
will initiate the Raft engine in charge of the pool membership and metadata. 
At this point, the DAOS pool is ready to be handed off to the actual workflow.</p>
<p>When the workflow starts, one rank connects to the DAOS pool, then uses 
local2global() to generate a global connection handle and shares it with all 
the other application ranks that use global2local() to create a local 
connection handle. At that point, new containers can be created and existing 
ones opened collectively or individually by the application tasks.</p>
<p><a id="62"></a></p>
<h2 id="workflow-execution">Workflow Execution<a class="headerlink" href="#workflow-execution" title="Permanent link">&para;</a></h2>
<p>We consider the workflow represented in the <a href="#6a">figure</a> below.</p>
<p><a id="6a"></a>
<img alt="../graph/Fig_007.png" src="../graph/Fig_007.png" title="Example of a Scientific Workflow" /></p>
<p>Each green box represents a different container. All containers are stored 
in the same DAOS pool represented by the gray box. The simulation reads data 
from the input container and writes raw timesteps to another container. 
It also regularly dumps checkpoints to a dedicated ckpt container. 
The down-sample job reads the raw timesteps and generates sampled timesteps 
to be analyzed by the post-process which stores analysis data into yet 
another container.</p>
<p><a id="63"></a></p>
<h3 id="bulk-synchronous-checkpoint">Bulk Synchronous Checkpoint<a class="headerlink" href="#bulk-synchronous-checkpoint" title="Permanent link">&para;</a></h3>
<p>Defensive I/O is used to manage a large simulation run over a period of time 
larger than the platform's mean time between failure (MTBF). The simulation 
regularly dumps the current computation state to a dedicated container used 
to guarantee forward progress in the event of failures. This section 
elaborates on how checkponting could be implemented on top of the DAOS 
storage stack. We first consider the traditional approach relying on 
blocking barriers and then a more loosely coupled execution.</p>
<p><b>Blocking Barrier</b></p>
<p>When the simulation job starts, one task opens the checkpoint container 
and fetches the current global HCE. It thens obtains an epoch hold and 
shares the data (the container handle, the current LHE and global HCE) 
with peer tasks. Each task checks for the latest computation state saved 
to the checkpoint container by reading with an epoch equal to the global 
HCE and resumes computation from where it was last checkpointed.</p>
<p>To checkpoint, each task executes a barrier to synchronize with the 
other tasks, writes its current computation state to the checkpoint 
container at epoch LHE, flushes all updates and finally executes another 
barrier. Once all tasks have completed the last barrier, one designated 
task (e.g. rank 0) commits the LHE which is then increased by one on 
successful commit. This process is repeated regularly until the simulation 
successfully completes.</p>
<p><b>Non-blocking Barrier</b></p>
<p>We now consider another approach to checkpointing where the execution is 
more loosely coupled. As in the previous case, one task is responsible for 
opening the checkpoint container, fetching the global HCE, obtaining an 
epoch hold and sharing the data with the other peer tasks. 
However, tasks can now checkpoint their computation state at their own pace 
without waiting for each other. After the computation of N timesteps, 
each task dumps its state to the checkpoint container at epoch LHE+1, 
flushes the changes and calls a non-blocking barrier (e.g. MPI_Ibarrier()) 
once done. Then after another N timesteps, the new checkpoint is written with 
epoch LHE+2 and so on. For each checkpoint, the epoch number is incremented.</p>
<p>Moreover, each task regularly calls MPI_Test() to check for barrier 
completion which allows them to recycle the MPI_Request. Upon barrier 
completion, one designated task (typically rank 0) also commits the 
associated epoch number. All epochs are guaranteed to be committed in 
sequence and each committed epoch is a new consistent checkpoint to 
restart from. On failure, checkpointed states that have been written by 
individual tasks, but not committed, are automatically rolled back.</p>
<p><a id="64"></a></p>
<h3 id="producerconsumer">Producer/Consumer<a class="headerlink" href="#producerconsumer" title="Permanent link">&para;</a></h3>
<p>In the previous <a href="6a">figure</a>, we have two examples of 
producer/consumer. The down-sample job consumes raw timesteps generated 
by the simulation job and produces sampled timesteps analyzed by the 
post-process job. The DAOS stack provides specific mechanims for 
producer/consumer workflow which even allows the consumer to dumps the 
result of its analysis into the same container as the producer.</p>
<p><b>Private Container</b></p>
<p>The down-sample job opens the sampled timesteps container, fetches the 
current global HCE, obtains an epoch hold and writes new sampled data to 
this container at epoch LHE. While this is occurring, the post process job 
opens the container storing analyzed data for write, checks for the latest 
analyzed timesteps and obtains an epoch hold on this container. It then 
opens the sampled timesteps container for read, and checks whether the next 
time-step to be consumed is ready. If not, it waits for a new global HCE to 
be committed (notified by asynchronous event completion on the event queue) 
and checks again. When the requested time-step is available, the down-sample 
job processes input data for this new time-step, dumps the results in its 
own container and updates the latest analyzed time-step in its metadata. 
It then commits updates to its output container and waits again for a new 
epoch to be committed and repeats the same process.</p>
<p>Another approach is for the producer job to create explicit snapshots for 
epochs of interest and have the analysis job waiting and processing 
snapshots. This avoid processing every single committed epoch.</p>
<p><b>Shared Container</b></p>
<p>We now assume that the container storing the sampled timesteps and the one 
storing the analyzed data are a single container. In other words, the 
down-sample job consumes input data and writes output data to the same 
container.</p>
<p>The down-sample job opens the shared container, obtains an hold and dumps 
new sampled timesteps to the container. As before, the post-process job also 
opens the container, fetches the latest analyzed timestep, but does not 
obtain an epoch hold until a new global HCE is ready. Once the post-process 
job is notified of a new global HCE, it can analyze the new sampled timesteps, 
obtain an hold and write its analyzed data to the same container. Once this 
is done, the post-process job flushes its updates, commits the held epoch and 
releases the held epoch. At that point, it can wait again for a new global 
HCE to be generated by the down-sample job.</p>
<p><a id="65"></a></p>
<h3 id="concurrent-producers">Concurrent Producers<a class="headerlink" href="#concurrent-producers" title="Permanent link">&para;</a></h3>
<p>In the previous section, we consider a producer and a consumer job concurrently 
reading and writing into the same container, but in disjoint objects. We now 
consider a workflow composed of concurrent producer jobs modifying the same 
container in a conflicting and uncoordinated manner. This effectively means 
that the two producers can update the same key of the same KV object or 
document store or overlapping extents of the same byte array. This model 
requires the implementation of a concurrency-control mechanism (not part of 
DAOS) to coordinate conflicting accesses. This section presents an example 
of such a mechanism based on locking, but alternative approaches can also be 
considered.</p>
<p>A workflow is composed of two applications using a distributed lock manager 
to serialize contended accesses to DAOS objects. Each application individually 
opens the same container and grabs an epoch hold whenever it wants to modify 
some objects in the container. Prior to modifying an object, an application 
should acquire a write lock on the object. This lock carries a lock value 
block (LVB) storing the last epoch number in which this object was last 
modified and committed. Once the lock is acquired, the writer must:</p>
<ul>
<li>read from an epoch equal to the greatest of the epoch specified in the 
  LVB and the handle LRE.</li>
<li>submit new writes with an epoch higher than the one in the LVB and the 
  currently held epoch.</li>
</ul>
<p>After all the I/O operations have been completed, flushed, and committed by 
the application, the LVB is updated with the committed epoch in which the 
object was modified, and the lock can finally be released.</p>
<p><a id="66"></a></p>
<h2 id="storage-node-failure-and-resilvering">Storage Node Failure and Resilvering<a class="headerlink" href="#storage-node-failure-and-resilvering" title="Permanent link">&para;</a></h2>
<p>In this section, we consider a workflow connected to a DAOS pool and one 
storage node that suddenly fails. Both DAOS clients and servers communicating 
with the failed server experience RPC timeouts and inform the RAS system. 
Failing RPCs are resent repeatedly until the RAS system or the pool metadata 
service itself decides to declare the storage node dead and evicts it from 
the pool map. The pool map update, along with the new version, is propagated 
to all the storage nodes that lazily (in RPC replies) inform clients that a 
new pool map version is available. Both clients and servers are thus 
eventually informed of the failure and enter into recovery mode.</p>
<p>Server nodes will cooperate to restore redundancy on different servers for 
the impacted objects, whereas clients will enter in degraded mode and read 
from other replicas, or reconstruct data from erasure code. This rebuild 
process is executed online while the container is still being accessed and 
modified. Once redundancy has been restored for all objects, the poolmap is 
updated again to inform everyone that the system has recovered from the fault 
and the system can exit from degraded mode.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2021 Intel Corporation
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.top", "navigation.indexes", "toc.integrate", "search.suggest", "search.highlight"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.409db549.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>